
allprojects {

    /** So all projects  have this in one place.
     */
    repositories {
        mavenLocal()
        mavenCentral()
    }
}


/** Call this with your subproject to be included in the tags file.
 *
 * This cooperative method is used for two reasons:
 *
 *  0.) It's opt in.
 *  1.) When using subprojects{}, none have a sourceSets property yet!
 *
 * Better solutions for gradle might be accepted as patches ;).
 * Stuff marked
 */
project.ext.includeInTags = { project ->
    if (!(project.hasProperty('sourceSets')
          && project.hasProperty('tags'))) {
        return false
    }

    def files = []
    project.sourceSets.each { ss ->
        ss.allSource.each { f ->
            files.add(f)
        }
    }

    // Defined here because it's purely opt-in by subprojects.
    task tags(type: Exec) {
        executable 'ctags'
        args files
    }
}

