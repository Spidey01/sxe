
/**
 * Makes the startup scripts pass -Djava.library.path argument for natives.
 * Gradle's application plugin doesn't provide a better way of doing this yet.
 * (gradle 1.4-1.6).
 */
project.startScripts {
    doLast {  
        unixScript.text = unixScript.text.replace(
            'exec "$JAVACMD" "${JVM_OPTS[@]}" -classpath "$CLASSPATH" ' + project.mainClassName,
            'exec "$JAVACMD" "${JVM_OPTS[@]}" -Djava.library.path=$APP_HOME/lib/natives -classpath "$CLASSPATH" ' + project.mainClassName
        )

        windowsScript.text = windowsScript.text.replace(
            '"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% ',
            '"%JAVA_EXE%" -Djava.library.path=%APP_HOME%\\lib\\natives %DEFAULT_JVM_OPTS% %JAVA_OPTS% '
        )
    }  
}

